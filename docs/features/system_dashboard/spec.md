# System Dashboard Specification (v1.0)
**Date:** 2026-02-17
**Status:** Planning
**Author:** Consigliere Agent

## 1. Overview
The **System Dashboard** is a graphical user interface (GUI) designed to visualize and manage the data generated by the Consigliere agent.
It serves as the central control room, allowing the user to view financial ledgers, monitor real estate market trends, and read daily news insights without interacting with the CLI or raw files.

## 2. Architecture
- **Framework:** [Streamlit](https://streamlit.io/) (Python-based UI).
- **Integration Pattern:** Direct Service Integration.
    - The dashboard will import and use existing Service classes (`FinanceAgent`, `RealEstateAgent`, `TransactionMonitorService`) directly.
    - This avoids the overhead of HTTP requests for local operations and leverages existing business logic.
- **State Management:** Streamlit Session State & `@st.cache_resource` for efficient service initialization.

## 3. User Stories & Features

### 3.1 Global Navigation (Sidebar)
- **Feature:** A persistent sidebar for navigation between domains.
- **Menu Items:**
    1.  ðŸ  **Home**: System status and quick summary.
    2.  ðŸ’° **Finance**: Ledger management.
    3.  ðŸ¢ **Real Estate**: Market monitoring and news.

### 3.2 Finance Dashboard (`/finance`)
- **Goal:** Visualize and edit monthly expenses.
- **Features:**
    - **Month Selector:** Dropdown to select `YYYY-MM`.
    - **Data Grid:** Display transactions from `data/Finance/Ledger_{YYYY}_{MM}.md` using `st.data_editor`.
        - **CRUD:** Allow users to **Edit** cells (Amount, Category, Item) and **Delete** rows directly in the grid.
        - **Add:** A simple form to add a structured transaction (bypassing NLP if desired, or using the existing NLP pipeline).
    - **Statistics:**
        - Total Monthly Expenditure.
        - Bar chart of expenses by Category.

### 3.3 Real Estate Dashboard (`/real_estate`)
This section is divided into two tabs:

#### Tab 1: Market Monitor
- **Goal:** View transaction data collected by the `TransactionMonitorService`.
- **Source:** ChromaDB (or raw fetch if not cached).
- **Features:**
    - **Filters:** Region (Dong), Deal Type (Buy/Rent), Date Range.
    - **Table:** Sortable table of transactions (Date, Apartment, Price, Floor).
    - **Metrics:** Average Price, Total Volume for the selected period.

#### Tab 2: News Insights
- **Goal:** Read daily AI-generated real estate reports.
- **Source:** Markdown files in `data/real_estate/news/`.
- **Features:**
    - **Date Picker:** Select a date to view the report.
    - **Report Viewer:** Render the Markdown report beautifully (Headers, Lists, Links).
    - **Search:** Keyword search within the currently loaded report.

## 4. Data Flow
1.  **Read:** Dashboard calls `Service.get_data()` -> Service reads Markdown/ChromaDB -> Returns Dict/DataFrame -> Dashboard renders.
2.  **Write (Finance):** User edits Grid -> Dashboard calls `Service.update_transaction()` -> Service rewrites Markdown file.
3.  **Trigger (Real Estate):** User clicks "Refresh Data" -> Dashboard calls `MonitorService.fetch_daily()` -> Data saved to DB -> UI updates.

## 5. Technical Requirements
- **Dependencies:**
    - `streamlit`
    - `pandas`
    - `plotly` (optional, for better charts)
    - `watchdog` (optional, for auto-reload on file change)
- **File Structure:**
    - `src/dashboard/main.py`: Entry point.
    - `src/dashboard/pages/`: Modular page logic.
    - `src/dashboard/components/`: Reusable UI widgets.

## 6. Future Scope
- User Authentication (if deployed remotely).
- Advanced Analytics (Year-over-Year comparison).
- n8n Workflow Trigger buttons directly from UI.
