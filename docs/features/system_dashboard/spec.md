# System Dashboard Specification (v1.0)
**Date:** 2026-02-17
**Status:** Planning
**Author:** Consigliere Agent

## 1. Overview
The **System Dashboard** is a graphical user interface (GUI) designed to visualize and manage the data generated by the Consigliere agent.
It serves as the central control room, allowing the user to view financial ledgers, monitor real estate market trends, and read daily news insights without interacting with the CLI or raw files.

## 2. Architecture
- **Framework:** [Streamlit](https://streamlit.io/) (Python-based UI).
- **Integration Pattern:** **REST API Integration** (Decoupled).
    - The dashboard acts as a pure API Client.
    - All data operations are performed via HTTP requests to the FastAPI backend (`src/main.py`).
    - This ensures clear separation of concerns, allowing the frontend to be replaced (e.g., with React) without changing backend logic.
- **State Management:** Streamlit Session State & `@st.cache_data` for API response caching.

## 3. User Stories & Features

### 3.1 Global Navigation (Sidebar)
- **Feature:** A persistent sidebar for navigation between domains.
- **Menu Items:**
    1.  ðŸ  **Home**: System status and quick summary.
    2.  ðŸ’° **Finance**: Ledger management.
    3.  ðŸ¢ **Real Estate**: Market monitoring and news.

### 3.2 Finance Dashboard (`/finance`)
- **Goal:** Visualize and edit monthly expenses.
- **Features:
    - **Month Selector:** Dropdown to select `YYYY-MM`.
    - **Data Grid:** Display transactions from `data/Finance/Ledger_{YYYY}_{MM}.md` using `st.data_editor`.
        - **CRUD:** Allow users to **Edit** cells (Amount, Category, Item) and **Delete** rows directly in the grid.
        - **Add:** A simple form to add a structured transaction (bypassing NLP if desired, or using the existing NLP pipeline).
    - **Statistics:**
        - Total Monthly Expenditure.
        - Bar chart of expenses by Category.

### 3.3 Real Estate Dashboard (`/real_estate`)
This section is divided into two tabs:

#### Tab 1: Market Monitor
- **Goal:** View transaction data collected by the `TransactionMonitorService`.
- **Source:** ChromaDB (or raw fetch if not cached).
- **Features:**
    - **Filters:** Region (Dong), Deal Type (Buy/Rent), Date Range.
    - **Table:** Sortable table of transactions (Date, Apartment, Price, Floor).
    - **Metrics:** Average Price, Total Volume for the selected period.

#### Tab 2: News Insights
- **Goal:** Read daily AI-generated real estate reports.
- **Source:** Markdown files in `data/real_estate/news/`.
- **Features:**
    - **Date Picker:** Select a date to view the report.
    - **Report Viewer:** Render the Markdown report beautifully (Headers, Lists, Links).
    - **Search:** Keyword search within the currently loaded report.

## 4. Data Flow
1.  **Read:** Dashboard sends `GET /api/dashboard/{domain}/...` -> API calls Service -> Returns JSON -> Dashboard renders.
2.  **Write (Finance):** User edits Grid -> Dashboard sends `POST /api/dashboard/finance/transaction` -> API updates Storage.
3.  **Trigger:** User actions trigger specific API endpoints (e.g., `/agent/real_estate/monitor/fetch`).

## 5. Technical Requirements
- **Dependencies:**
    - `streamlit`
    - `pandas`
    - `requests` (New)
    - `plotly`
- **File Structure:**
    - `src/dashboard/api_client.py`: Centralized API wrapper.

## 6. Future Scope
- User Authentication (if deployed remotely).
- Advanced Analytics (Year-over-Year comparison).
- n8n Workflow Trigger buttons directly from UI.
